<form [formGroup]="form" autocomplete="off">

  <div class="row">
    <div class="col-sm mb-3">
      <label for="source" class="form-label">Source</label>
      <input type="text" class="form-control" id="source" formControlName="source" placeholder="Enter source">
    </div>
    <div class="col-sm mb-3">
      <label for="po_nbr" class="form-label">P.O No.</label>
      <input type="text" class="form-control" id="po_nbr" formControlName="po_nbr" placeholder="Enter PO Number">
    </div>
    <div class="col-sm mb-3">
      <app-qad-wo-search (notifyParent)="setOrkOrderNumber($event)" [value]="f.wo_nbr.value"
        [disabled]="this.form.disabled" [addTag]="true"></app-qad-wo-search>
    </div>
  </div>

  <div class="form-check form-check-inline text-center mt-1 mb-4" *ngFor="let row of ncr_types; let i = index"
    formArrayName="ncr_type">
    <label class="form-check-label">
      <input type="checkbox" class="form-check-input" [formControlName]="i">
      <i class="input-frame"></i>
      {{row}}
    </label>
  </div>

  <div class="row">
    <div class="col mb-3">
      <label for="ca_due_dt" class="form-label">Complaint Code</label>
      <select class="form-select" formControlName="complaint_code">
        <option selected disabled value="null">--SELECT--</option>
        <option *ngFor="let row of complaint_codes" [value]="row.name">{{row.name}}</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div class="col mb-3">
      <app-qir-search (notifyParent)="notifyParent($event)" [value]="f.qir_number.value"
        [disabled]="this.form.disabled"></app-qir-search>
    </div>
  </div>

  <div class="row">
    <div class="col-sm mb-3">
      <label for="pt_nbr" class="form-label">Part No.</label>
      <input type="text" class="form-control" id="pt_nbr" formControlName="pt_nbr" placeholder="Enter Part Number">
    </div>
    <div class="col-sm mb-3">
      <label for="rev" class="form-label">Rev:</label>
      <input type="text" class="form-control" id="rev" formControlName="rev" placeholder="Enter REV Number">
    </div>
    <div class="col-sm mb-3">
      <label for="initiated_by" class="form-label">Initiated By:</label>
      <input type="text" class="form-control" id="initiated_by" formControlName="initiated_by" placeholder="Enter name">
    </div>
    <div class="col-sm mb-3">
      <label for="ret_nbr" class="form-label">Return No.</label>
      <input type="text" class="form-control" id="ret_nbr" formControlName="ret_nbr" placeholder="Enter return number">
    </div>
  </div>

  <div class="row">
    <div class="col-sm mb-3">
      <label for="acc" class="form-label">Acc.</label>
      <input type="text" class="form-control" id="acc" formControlName="acc" placeholder="Enter acc">
    </div>
    <div class="col-sm mb-3">
      <label for="rej" class="form-label">Rej.</label>
      <input type="text" class="form-control" id="rej" formControlName="rej" placeholder="Enter reject">
    </div>
    <div class="col-sm mb-3">
      <label for="sample_size" class="form-label">Sample Size:</label>
      <input type="text" class="form-control" id="sample_size" formControlName="sample_size"
        placeholder="Enter sample size">
    </div>
    <div class="col-sm mb-3">
      <label for="dept_operator" class="form-label">Dept./Operator</label>
      <input type="text" class="form-control" id="dept_operator" formControlName="dept_operator"
        placeholder="Enter department/Operator name">
    </div>
    <div class="col-sm mb-3">
      <label for="finished_nbr" class="form-label">Finished #</label>
      <input type="text" class="form-control" id="finished_nbr" formControlName="finished_nbr"
        placeholder="Enter finished number">
    </div>
  </div>

  <div class="row">
    <div class="col mb-3">
      <label for="desc_of_defn_rej" class="form-label">Description of Deficiency/Rejection</label>
      <textarea type="text" class="form-control" id="desc_of_defn_rej" formControlName="desc_of_defn_rej"
        placeholder="Enter description" rows="10"></textarea>
    </div>
  </div>

  <div class="card-body p-3 border border-secondary mb-3">
    <div class="row">
      <div class="col mb-3">
        <label for="cont_notes" class="form-label ps-2 pt-2">Containment</label>
        <textarea type="text" class="form-control" id="cont_notes" formControlName="cont_notes" rows="10"
          placeholder="Enter containment"></textarea>
      </div>
    </div>

    <div class="form-check form-check-inline text-center mb-3" *ngFor="let row of cont_types; let i = index"
      formArrayName="cont_type">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" [formControlName]="i">
        <i class="input-frame"></i>
        {{row}}
      </label>
    </div>

    <div class="row">
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light">Dspn by:</div>
          </div>
          <input type="text" class="form-control" id="cont_dspn_by" formControlName="cont_dspn_by"
            placeholder="Enter disposition by">
        </div>
      </div>
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light">Ttile:</div>
          </div>
          <input type="text" class="form-control" id="cont_dspn_title" formControlName="cont_dspn_title"
            placeholder="Enter title">
        </div>
      </div>
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light">Dt:</div>
          </div>
          <input type="date" class="form-control" id="cont_dspn_dt" placeholder="cont_dspn_dt"
            formControlName="cont_dspn_dt">
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col mb-3">
      <label for="dspn_desc" class="form-label ">Disposition/Rework/Repair Instructions</label>
      <textarea type="text" class="form-control" id="dspn_desc" formControlName="dspn_desc" rows="10"
        placeholder="Enter Disposition/Rework/Repair Instructions"></textarea>
    </div>
  </div>

  <div class="row">
    <div class="col mb-4">
      <label for="impact_assesment" class="form-label">Impact assessment of nonconformity on other
        product(s) and/or process(es):</label>
      <textarea type="text" class="form-control" id="impact_assesment" formControlName="impact_assesment" rows="10"
        placeholder="Enter Impact assessment of nonconformity on other product(s) and/or process(es):"></textarea>
    </div>
  </div>

  <div class="card-body p-3 border border-secondary mb-3">
    <div class="row">
      <div class="col mb-3">
        <label for="icm_notes" class="form-label ps-2 pt-2">Immediate Correction Made</label>
        <textarea type="text" class="form-control" id="icm_notes" formControlName="icm_notes" rows="10"
          placeholder="Enter Immediate Correction Made"></textarea>
      </div>
    </div>

    <div class="row">
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light border-right-0">Dspn by:</div>
          </div>
          <input type="text" class="form-control" id="icm_dspn_by" formControlName="icm_dspn_by"
            placeholder="Enter Disposition By">
        </div>
      </div>
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light">Title:</div>
          </div>
          <input type="text" class="form-control" id="icm_dspn_title" formControlName="icm_dspn_title"
            placeholder="Enter Title">
        </div>
      </div>
      <div class="col-sm mb-3">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text bg-light">Dt:</div>
          </div>
          <input type="date" class="form-control" id="icm_dspn_dt" formControlName="icm_dspn_dt">
        </div>
      </div>
    </div>
  </div>

  <h4 class="p-2 bg-light mb-3 text-center">Corrective Action</h4>
  <div class="mb-3">
    <label for="ca_action_req" class="form-label me-2">Corrective Action Required?</label>
    <div class="form-check form-check-inline" *ngFor="let row of ['Yes', 'No']">
      <label class="form-check-label">
        <input type="radio" class="form-check-input" name="ca_action_req" id="ca_action_req" [value]="row"
          formControlName="ca_action_req" placeholder="Enter Issued By">
        <i class="input-frame"></i>
        {{row}}
      </label>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-7 mb-3">
      <label for="iss_by" class="form-label">Issued By:</label>
      <input type="text" class="form-control" id="iss_by" formControlName="iss_by" placeholder="Enter Issued By">
    </div>
    <div class="col-sm mb-3">
      <label for="iss_dt" class="form-label">Issued Date:</label>
      <input type="date" class="form-control" id="iss_dt" formControlName="iss_dt">
    </div>
  </div>

  <div class="row">
    <div class="col-sm-4 mb-3">
      <label for="ca_iss_to" class="form-label">Corrective Action Issued To</label>
      <select class="form-select" id="ca_iss_to" formControlName="ca_iss_to">
        <option selected disabled value="">--SELECT--</option>
        <option *ngFor="let row of corrective_action_issued_to">{{row}}</option>
      </select>
    </div>
    <div class="col-sm mb-3">
      <label for="ca_due_dt" class="form-label">Due Date</label>
      <input type="date" class="form-control" id="ca_due_dt" formControlName="ca_due_dt">
    </div>
  </div>


  <button class="btn btn-primary mb-3" (click)="onSendEmailToDepartment()"
    [disabled]="this.form.value?.ca_action_req == 'No' || !this.form.value?.ca_action_req">
    Email Corrective Action
  </button>

  <p *ngIf="this.form.value?.ca_email_sent_date_time">Email sent on {{this.form.value?.ca_email_sent_date_time}}</p>
  <p *ngIf="this.form.value?.ca_email_sent_to">Email sent to: {{this.form.value?.ca_email_sent_to}}</p>
</form>