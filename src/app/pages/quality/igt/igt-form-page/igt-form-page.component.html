<div class="container-fluid" *ngIf="mode === 'create'">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-11 col-xl-10 col-xxl-8">
      
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item">
            <a href="#" class="text-decoration-none" (click)="$event.preventDefault(); onCancel()">
              <i class="mdi mdi-home-outline me-1"></i>Quality
            </a>
          </li>
          <li class="breadcrumb-item">
            <a href="#" class="text-decoration-none" (click)="$event.preventDefault(); onCancel()">
              IGT Assets
            </a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            Create New Record
          </li>
        </ol>
      </nav>
      
      <!-- Page Header with Context -->
      <div class="mb-4">
        <div class="d-flex align-items-center mb-3">
          <button 
            type="button" 
            class="btn btn-outline-secondary me-3"
            (click)="goBack()"
            title="Back to IGT List">
            <i class="mdi mdi-arrow-left me-2"></i>Back
          </button>
          <div class="bg-primary bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
            <i class="mdi mdi-plus text-white fs-4"></i>
          </div>
          <div>
            <h2 class="mb-1 text-primary">Create IGT Asset Record</h2>
            <p class="text-muted mb-0">Initialize a new Interactive Gaming Technology asset with comprehensive tracking</p>
          </div>
        </div>
        
        <div class="alert alert-primary border-primary border-opacity-25 bg-primary bg-opacity-10" role="alert">
          <div class="d-flex align-items-start">
            <i class="mdi mdi-information-outline text-primary me-3 mt-1 fs-5"></i>
            <div>
              <h6 class="alert-heading text-primary mb-2">Creating a New IGT Asset</h6>
              <p class="mb-2">
                IGT assets require <strong>unique serial number tracking</strong> for gaming compliance. 
                Once created, quality control workflows are automatically initiated.
              </p>
              <div class="row g-2 small">
                <div class="col-md-6">
                  <i class="mdi mdi-check-circle text-success me-1"></i>
                  Auto-generated compliance numbers
                </div>
                <div class="col-md-6">
                  <i class="mdi mdi-database-sync text-info me-1"></i>
                  Real-time validation against QAD
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Serial Number Availability Alert -->
        <!-- <div class="alert alert-success border-success border-opacity-25 bg-success bg-opacity-10" role="alert" *ngIf="getAvailableSerialCount() > 0">
          <div class="d-flex align-items-start">
            <i class="mdi mdi-barcode-scan text-success me-3 mt-1 fs-5"></i>
            <div class="flex-grow-1">
              <h6 class="alert-heading text-success mb-2">Serial Number Inventory</h6>
              <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex gap-4">
                  <span><strong>{{getAvailableSerialCount()}}</strong> Available</span>
                  <span><strong>{{getTotalSerialCount()}}</strong> Total</span>
                </div>
                <button type="button" class="btn btn-outline-success btn-sm" (click)="goToSerialManager()">
                  <i class="mdi mdi-cog me-1"></i>Manage Serials
                </button>
              </div>
              <div *ngIf="getAvailableSerialCount() < 10" class="mt-2 small text-warning">
                <i class="mdi mdi-alert-outline me-1"></i>
                Low inventory - consider adding more serial numbers.
              </div>
            </div>
          </div>
        </div> -->

        <!-- No Serial Numbers Warning -->
        <div class="alert alert-danger border-danger border-opacity-25 bg-danger bg-opacity-10" role="alert" *ngIf="availableSerialCount === 0">
          <div class="d-flex align-items-start">
            <i class="mdi mdi-alert-circle text-danger me-3 mt-1 fs-5"></i>
            <div>
              <h6 class="alert-heading text-danger mb-2">Cannot Create IGT Asset</h6>
              <p class="mb-3">
                <strong>No available serial numbers found.</strong> You must upload serial numbers before creating IGT assets.
              </p>
              <button class="btn btn-danger btn-sm" (click)="goToSerialManager()">
                <i class="mdi mdi-upload me-1"></i>Upload Serial Numbers
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <app-igt-form (setFormEmitter)="setFormEmitter($event)" [submitted]="submitted"></app-igt-form>
        </div>
        
        <div class="card-footer bg-light border-top d-flex p-3">
          <div class="d-flex align-items-center me-auto">
            <span class="small text-muted me-2">Label Size:</span>
            <div class="btn-group" role="group">
              <input 
                type="radio" 
                class="btn-check" 
                name="labelSizeCreate" 
                id="fullSizeCreate" 
                autocomplete="off" 
                [checked]="!useCompactLabel"
                (change)="useCompactLabel = false">
              <label class="btn btn-outline-secondary btn-sm" for="fullSizeCreate">
                <i class="mdi mdi-card-outline me-1"></i>Full
              </label>
              
              <input 
                type="radio" 
                class="btn-check" 
                name="labelSizeCreate" 
                id="compactSizeCreate" 
                autocomplete="off" 
                [checked]="useCompactLabel"
                (change)="useCompactLabel = true">
              <label class="btn btn-outline-secondary btn-sm" for="compactSizeCreate">
                <i class="mdi mdi-card me-1"></i>4Ã—2
              </label>
            </div>
          </div>
          <button type="button" class="btn btn-outline-secondary me-2" [disabled]="isLoading" (click)="onCancel()">
            <i class="mdi mdi-close me-1"></i>Cancel
          </button>
          <button type="submit" class="btn btn-primary" 
                  [disabled]="isLoading || availableSerialCount === 0" 
                  (click)="onSubmit()"
                  [title]="availableSerialCount === 0 ? 'No available serial numbers. Please upload serial numbers first.' : ''">
            @if (isLoading) {
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Creating Record...
            } @else if (availableSerialCount > 0) {
              <i class="mdi mdi-check-circle-outline me-1"></i>Create IGT Record
            } @else {
              <i class="mdi mdi-alert me-1"></i>No Serial Numbers Available
            }
          </button>
        </div>
      </div>
      
    </div>
  </div>
</div>

<!-- Edit Mode -->
<div class="container-fluid" *ngIf="mode === 'edit'">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-11 col-xl-10 col-xxl-9">
      
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb mb-0">
          <li class="breadcrumb-item">
            <a href="#" class="text-decoration-none" (click)="$event.preventDefault(); onCancel()">
              <i class="mdi mdi-home-outline me-1"></i>Quality
            </a>
          </li>
          <li class="breadcrumb-item">
            <a href="#" class="text-decoration-none" (click)="$event.preventDefault(); onCancel()">
              IGT Assets
            </a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            Edit Record #{{id}}
          </li>
        </ol>
      </nav>
      
      <!-- Page Header with Context -->
      <div class="mb-4">
        <div class="d-flex align-items-center mb-3">
          <button 
            type="button" 
            class="btn btn-outline-secondary me-3"
            (click)="goBack()"
            title="Back to IGT List">
            <i class="mdi mdi-arrow-left me-2"></i>Back
          </button>
          <div class="bg-warning bg-gradient rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
            <i class="mdi mdi-pencil text-white fs-4"></i>
          </div>
          <div>
            <h2 class="mb-1 text-warning">Edit IGT Asset Record</h2>
            <p class="text-muted mb-0" *ngIf="id">Modify existing IGT asset record #{{id}}</p>
          </div>
        </div>
        
        <div class="alert alert-warning border-warning border-opacity-25 bg-warning bg-opacity-10" role="alert" *ngIf="data && id">
          <div class="d-flex align-items-start">
            <i class="mdi mdi-pencil-outline text-warning me-3 mt-1 fs-5"></i>
            <div>
              <h6 class="alert-heading text-warning mb-2">Edit Mode Active</h6>
              <p class="mb-2">
                You are currently editing IGT record #{{id}}. All changes are <strong>tracked and audited</strong> for compliance.
              </p>
              <div class="row g-2 small">
                <div class="col-md-6">
                  <i class="mdi mdi-lock text-info me-1"></i>
                  Asset numbers cannot be modified
                </div>
                <div class="col-md-6">
                  <i class="mdi mdi-printer text-secondary me-1"></i>
                  Use "Print Label" for updated labels
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card shadow-sm border-0">
        <div class="card-header bg-warning bg-gradient text-white">
          <h4 class="card-title mb-0 text-white">
            <i class="mdi mdi-gamepad-variant me-2"></i>IGT Asset Information
          </h4>
        </div>
        
        <div class="card-body p-4">
          <app-igt-form (setFormEmitter)="setFormEmitter($event)" [submitted]="submitted"></app-igt-form>
        </div>
        
        <div class="card-footer bg-light border-top d-flex p-3">
          <div class="text-muted small me-auto align-self-center" *ngIf="data">
            <i class="mdi mdi-history text-info me-1"></i>
            Last modified: {{data?.lastUpdate | date:'medium'}}
          </div>
          <div class="d-flex align-items-center me-3">
            <span class="small text-muted me-2">Label Size:</span>
            <div class="btn-group" role="group">
              <input 
                type="radio" 
                class="btn-check" 
                name="labelSize" 
                id="fullSize" 
                autocomplete="off" 
                [checked]="!useCompactLabel"
                (change)="useCompactLabel = false">
              <label class="btn btn-outline-secondary btn-sm" for="fullSize">
                <i class="mdi mdi-card-outline me-1"></i>Full
              </label>
              
              <input 
                type="radio" 
                class="btn-check" 
                name="labelSize" 
                id="compactSize" 
                autocomplete="off" 
                [checked]="useCompactLabel"
                (change)="useCompactLabel = true">
              <label class="btn btn-outline-secondary btn-sm" for="compactSize">
                <i class="mdi mdi-card me-1"></i>4Ã—2
              </label>
            </div>
          </div>
          <button type="button" class="btn btn-outline-secondary me-2" [disabled]="isLoading" (click)="onCancel()">
            <i class="mdi mdi-close me-1"></i>Cancel
          </button>
          <button type="button" class="btn btn-outline-primary me-2" [disabled]="isLoading" (click)="onPrint()">
            <i class="mdi mdi-printer me-1"></i>Print Label
          </button>
          <button type="submit" class="btn btn-success" [disabled]="isLoading" (click)="onSubmit()">
            @if (isLoading) {
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Updating...
            } @else {
              <i class="mdi mdi-content-save me-1"></i>Update Record
            }
          </button>
        </div>
      </div>
      
    </div>
  </div>
</div>


