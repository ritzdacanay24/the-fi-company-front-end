<form [formGroup]="form" autocomplete="off">

  <!-- Header Section -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-body bg-warning position-relative overflow-hidden text-dark">
      <div class="position-absolute" style="top: -20px; right: -20px; opacity: 0.1;">
        <i class="mdi mdi-forklift" style="font-size: 8rem;"></i>
      </div>
      <div class="d-flex align-items-center position-relative">
        <div class="me-3">
          <div class="bg-dark bg-opacity-25 rounded-circle p-3 d-inline-flex">
            <i class="mdi mdi-forklift text-dark" style="font-size: 1.5rem;"></i>
          </div>
        </div>
        <div>
          <h3 class="mb-1 fw-bold text-dark">Forklift Inspection Report</h3>
          <p class="mb-0 text-dark opacity-75">Daily forklift safety and operational inspection</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Operator Information Card -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-body-tertiary border-0">
      <h5 class="card-title mb-1 text-body-secondary">
        <i class="mdi mdi-account-hard-hat me-2"></i>Operator Information
      </h5>
      <small class="text-body-secondary">Person conducting the forklift inspection</small>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-lg-4 mb-3">
          <label class="form-label required">Inspection Date & Time</label>
          <input type="datetime-local" class="form-control" formControlName="date_created"
              placeholder="Select date and time"
              [ngClass]="{ 'is-invalid': submitted && f['date_created'].errors }">
        </div>
        <div class="col-lg-4 mb-3">
          <label class="form-label required">Operator Name</label>
          <input type="text" class="form-control" formControlName="operator" 
              placeholder="Enter operator's full name"
              [ngClass]="{ 'is-invalid': submitted && f['operator'].errors }">
        </div>
        <div class="col-lg-4 mb-3">
          <label class="form-label required">Forklift Selection</label>
          <select class="form-select" formControlName="model_number"
              [ngClass]="{ 'is-invalid': submitted && f['model_number'].errors }">
            <option value="" selected disabled>Select forklift to inspect</option>
            <optgroup *ngFor="let row of formValues?.models" [label]="row.name">
              <option *ngFor="let row1 of row.details" [value]="row1.name">{{row1.name}}</option>
            </optgroup>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Safety Notice Card -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body bg-info bg-opacity-10">
      <div class="d-flex align-items-start">
        <div class="bg-info bg-opacity-25 rounded-circle p-2 me-3 flex-shrink-0">
          <i class="mdi mdi-information text-info"></i>
        </div>
        <div>
          <h6 class="text-info mb-2 fw-semibold">Safety Inspection Requirements</h6>
          <p class="text-body mb-0 small">
            Complete all safety and operational checks prior to each shift. Any identified problems must be corrected by qualified maintenance personnel before operating the forklift.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Inspection Checklist Card -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-body-tertiary border-0">
      <h5 class="card-title mb-1 text-body-secondary">
        <i class="mdi mdi-clipboard-check me-2"></i>Safety & Operational Inspection
      </h5>
      <small class="text-body-secondary">Complete all safety and operational checks</small>
    </div>
    <div class="card-body">
      <div class="inspection-section mb-4" *ngFor="let row of formValues?.checklist; let i = index">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-warning text-dark">
            <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between">
              <div class="flex-grow-1 mb-3 mb-md-0">
                <h6 class="mb-0 text-dark fw-semibold">{{row.name}}</h6>
              </div>
              <div class="d-flex flex-column flex-sm-row gap-2">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input bg-success border-success" id="status-{{i}}"
                    [(ngModel)]="row.status" [ngModelOptions]="{standalone: true}"
                    (change)="groupSelect(row, row.details, 'status')" [disabled]="this.form.disabled">
                  <label class="form-check-label text-dark fw-medium" for="status-{{i}}">
                    <i class="mdi mdi-check-all me-1"></i>All Pass
                  </label>
                </div>
                <div class="form-check">
                  <input type="checkbox" class="form-check-input bg-danger border-danger" id="needMaint-{{i}}"
                    [(ngModel)]="row.needMaint" [ngModelOptions]="{standalone: true}"
                    (change)="groupSelect(row, row.details, 'needMaint')" [disabled]="this.form.disabled">
                  <label class="form-check-label text-dark fw-medium" for="needMaint-{{i}}">
                    <i class="mdi mdi-alert me-1"></i>Has Failures
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body p-0">
            <!-- Mobile-friendly layout -->
            <div class="d-block d-lg-none">
              <div *ngFor="let row1 of row.details; let ii = index;" class="border-bottom">
                <div class="p-4">
                  <!-- Item Header -->
                  <div class="mb-3">
                    <h6 class="fw-semibold text-body mb-2">{{row1.name}}</h6>
                    <div class="mb-2" *ngIf="row1.error">
                      <span class="badge bg-danger">Required</span>
                    </div>
                  </div>
                  
                  <!-- Action Buttons -->
                  <div class="d-grid gap-2">
                    <div class="row g-2">
                      <div class="col-6">
                        <div class="form-check p-0">
                          <input type="radio" class="btn-check" id="pass-mobile-{{i}}-{{ii}}"
                            name="{{row.name}}{{row1.name}}{{ii}}" [(ngModel)]="row1.status"
                            [ngModelOptions]="{standalone: true}" [value]="1" [disabled]="this.form.disabled">
                          <label class="btn btn-outline-success w-100 d-flex align-items-center justify-content-center" 
                                 for="pass-mobile-{{i}}-{{ii}}"
                                 [ngClass]="{'btn-success text-white': row1.status === 1}">
                            <i class="mdi mdi-check-circle me-2" *ngIf="row1.status === 1"></i>
                            <i class="mdi mdi-check me-2" *ngIf="row1.status !== 1"></i>
                            Pass
                          </label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check p-0">
                          <input type="radio" class="btn-check" id="fail-mobile-{{i}}-{{ii}}"
                            [(ngModel)]="row1.status" [ngModelOptions]="{standalone: true}"
                            name="{{row.name}}{{row1.name}}{{ii}}" [value]="0" [disabled]="this.form.disabled">
                          <label class="btn btn-outline-danger w-100 d-flex align-items-center justify-content-center" 
                                 for="fail-mobile-{{i}}-{{ii}}"
                                 [ngClass]="{'btn-danger text-white': row1.status === 0}">
                            <i class="mdi mdi-close-circle me-2" *ngIf="row1.status === 0"></i>
                            <i class="mdi mdi-close me-2" *ngIf="row1.status !== 0"></i>
                            Fail
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Desktop layout -->
            <div class="d-none d-lg-block">
              <div class="table-responsive">
                <table class="table table-hover mb-0">
                  <thead class="table-light">
                    <tr>
                      <th style="width: 60%;">Inspection Item</th>
                      <th style="width: 20%;" class="text-center">Pass</th>
                      <th style="width: 20%;" class="text-center">Fail</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="align-middle" *ngFor="let row1 of row.details; let ii = index;">
                      <td class="ps-4">
                        <div class="py-2">
                          <div class="fw-semibold text-body">{{row1.name}}</div>
                          <div *ngIf="row1.error" class="mt-1">
                            <span class="badge bg-danger">Required</span>
                          </div>
                        </div>
                      </td>
                      <td class="text-center">
                        <div class="form-check d-inline-block">
                          <input type="radio" class="btn-check" id="pass-{{i}}-{{ii}}"
                            name="{{row.name}}{{row1.name}}{{ii}}" [(ngModel)]="row1.status"
                            [ngModelOptions]="{standalone: true}" [value]="1" [disabled]="this.form.disabled">
                          <label class="btn btn-outline-success" for="pass-{{i}}-{{ii}}"
                                 [ngClass]="{'btn-success text-white': row1.status === 1}">
                            <i class="mdi mdi-check-circle me-1" *ngIf="row1.status === 1"></i>
                            <i class="mdi mdi-check me-1" *ngIf="row1.status !== 1"></i>
                            Pass
                          </label>
                        </div>
                      </td>
                      <td class="text-center">
                        <div class="form-check d-inline-block">
                          <input type="radio" class="btn-check" id="fail-{{i}}-{{ii}}"
                            [(ngModel)]="row1.status" [ngModelOptions]="{standalone: true}"
                            name="{{row.name}}{{row1.name}}{{ii}}" [value]="0" [disabled]="this.form.disabled">
                          <label class="btn btn-outline-danger" for="fail-{{i}}-{{ii}}"
                                 [ngClass]="{'btn-danger text-white': row1.status === 0}">
                            <i class="mdi mdi-close-circle me-1" *ngIf="row1.status === 0"></i>
                            <i class="mdi mdi-close me-1" *ngIf="row1.status !== 0"></i>
                            Fail
                          </label>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Comments Card -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-body-tertiary border-0">
      <h5 class="card-title mb-1 text-body-secondary">
        <i class="mdi mdi-comment-text me-2"></i>Additional Comments
      </h5>
      <small class="text-body-secondary">Any additional observations, maintenance notes, or safety concerns</small>
    </div>
    <div class="card-body">
      <textarea class="form-control" rows="4" id="comment" formControlName="comments" 
        placeholder="Enter any additional comments, maintenance observations, or safety concerns..."></textarea>
    </div>
  </div>

</form>