<div class="sn-upload-container">
  <div class="header-section">
    <h3><i class="fas fa-plus-square"></i> Add EyeFi Serial Number Range</h3>
    <p class="subtitle">Add physical EyeFi device serial numbers to the database</p>
  </div>

  <!-- Range Input Section -->
  <div class="range-section card">
    <div class="card-header">
      <h4><i class="fas fa-list-ol"></i> Serial Number Range</h4>
    </div>
    <div class="card-body">
      <p class="mb-3">Enter the range of physical EyeFi device serial numbers you want to add to the database.</p>
      
      <!-- Range Input Method Selection -->
      <div class="mb-4">
        <label class="form-label">Input Method</label>
        <div class="btn-group w-100" role="group">
          <input type="radio" class="btn-check" name="inputMethod" id="rangeMethod" 
                 value="range" [(ngModel)]="inputMethod" autocomplete="off" checked>
          <label class="btn btn-outline-primary" for="rangeMethod">
            <i class="fas fa-arrows-alt-h"></i> Range Input (eyefi-1 to eyefi-200)
          </label>
          
          <input type="radio" class="btn-check" name="inputMethod" id="listMethod" 
                 value="list" [(ngModel)]="inputMethod" autocomplete="off">
          <label class="btn btn-outline-primary" for="listMethod">
            <i class="fas fa-list"></i> Individual List
          </label>
        </div>
      </div>

      <!-- Range Input Form -->
      <div *ngIf="inputMethod === 'range'">
        <div class="row">
          <div class="col-md-4">
            <label class="form-label">Prefix</label>
            <input 
              type="text" 
              class="form-control"
              [(ngModel)]="rangePrefix"
              placeholder="eyefi"
              maxlength="20">
            <small class="form-text text-muted">Common prefix for all serial numbers</small>
          </div>
          <div class="col-md-3">
            <label class="form-label">Start Number</label>
            <input 
              type="number" 
              class="form-control"
              [(ngModel)]="rangeStart"
              placeholder="1"
              min="0"
              max="999999">
          </div>
          <div class="col-md-3">
            <label class="form-label">End Number</label>
            <input 
              type="number" 
              class="form-control"
              [(ngModel)]="rangeEnd"
              placeholder="200"
              min="0"
              max="999999">
          </div>
          <div class="col-md-2">
            <label class="form-label">Padding</label>
            <select class="form-control" [(ngModel)]="rangePadding">
              <option value="0">None</option>
              <option value="2">2 digits (01, 02...)</option>
              <option value="3">3 digits (001, 002...)</option>
              <option value="4">4 digits (0001, 0002...)</option>
            </select>
          </div>
        </div>
        
        <div class="mt-3">
          <button 
            class="btn btn-info btn-sm"
            (click)="generatePreview()"
            [disabled]="!isValidRange()">
            <i class="fas fa-eye"></i> Preview Range
          </button>
          <span class="ml-3 text-muted" *ngIf="isValidRange()">
            Will generate {{ getRangeCount() }} serial numbers
          </span>
        </div>
      </div>

      <!-- Individual List Input -->
      <div *ngIf="inputMethod === 'list'">
        <label class="form-label">Serial Numbers</label>
        <textarea 
          class="form-control" 
          rows="8"
          [(ngModel)]="individualList"
          placeholder="Enter serial numbers, one per line:&#10;eyefi-001&#10;eyefi-002&#10;eyefi-003"></textarea>
        <small class="form-text text-muted">Enter one serial number per line</small>
        
        <div class="mt-2">
          <button 
            class="btn btn-info btn-sm"
            (click)="parseIndividualList()"
            [disabled]="!individualList?.trim()">
            <i class="fas fa-eye"></i> Preview List
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Preview and Submit Section -->
  <div class="preview-section card" *ngIf="previewSerialNumbers.length > 0">
    <div class="card-header">
      <h4><i class="fas fa-eye"></i> Preview Serial Numbers</h4>
      <span class="badge badge-info">{{ previewSerialNumbers.length }} numbers</span>
    </div>
    <div class="card-body">
      <div class="preview-list">
        <div class="row">
          <div class="col-md-3" *ngFor="let serial of previewSerialNumbers.slice(0, 20)">
            <code>{{ serial }}</code>
          </div>
        </div>
        <div *ngIf="previewSerialNumbers.length > 20" class="mt-2">
          <em class="text-muted">... and {{ previewSerialNumbers.length - 20 }} more</em>
        </div>
      </div>
      
      <div class="mt-4 pt-3 border-top">
        <button 
          class="btn btn-success btn-lg"
          (click)="addRangeToDatabase()"
          [disabled]="isUploading">
          <span *ngIf="!isUploading">
            <i class="fas fa-database"></i> Add {{ previewSerialNumbers.length }} Serial Numbers to Database
          </span>
          <span *ngIf="isUploading">
            <i class="fas fa-spinner fa-spin"></i> Adding to Database...
          </span>
        </button>
        
        <button 
          class="btn btn-outline-secondary ml-3"
          (click)="resetForm()"
          [disabled]="isUploading">
          <i class="fas fa-times"></i> Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Results Section -->
  <div class="results-section card" *ngIf="uploadResult">
    <div class="card-header" [class.bg-success]="uploadResult.success" [class.bg-danger]="!uploadResult.success">
      <h4 class="text-white">
        <i class="fas" [ngClass]="uploadResult.success ? 'fa-check-circle' : 'fa-exclamation-triangle'"></i>
        {{ uploadResult.success ? 'Success' : 'Error' }}
      </h4>
    <div class="card-body">
      <div class="result-summary">
        <p class="mb-3">{{ uploadResult.message }}</p>
        
        <div class="result-stats row">
          <div class="col-md-3 text-center">
            <div class="stat-card">
              <h5 class="stat-number">{{ uploadResult.totalRows }}</h5>
              <p class="stat-label">Total Added</p>
            </div>
          </div>
          <div class="col-md-3 text-center">
            <div class="stat-card">
              <h5 class="stat-number text-success">{{ uploadResult.successCount }}</h5>
              <p class="stat-label">Successful</p>
            </div>
          </div>
          <div class="col-md-3 text-center" *ngIf="uploadResult.errorCount > 0">
            <div class="stat-card">
              <h5 class="stat-number text-danger">{{ uploadResult.errorCount }}</h5>
              <p class="stat-label">Errors</p>
            </div>
          </div>
        </div>

        <!-- Error Details -->
        <div class="alert alert-danger mt-3" *ngIf="uploadResult.errors && uploadResult.errors.length > 0">
          <h6><i class="fas fa-exclamation-circle"></i> Errors:</h6>
          <ul class="mb-0">
            <li *ngFor="let error of uploadResult.errors">{{ error }}</li>
          </ul>
        </div>

        <div class="mt-4">
          <button 
            class="btn btn-primary"
            (click)="resetForm()">
            <i class="fas fa-plus"></i> Add More Serial Numbers
          </button>
          
          <button 
            class="btn btn-outline-success ml-2"
            routerLink="../list"
            *ngIf="uploadResult.success">
            <i class="fas fa-list"></i> View All Serial Numbers
          </button>
        </div>
      </div>
    </div>
  </div>
</div>