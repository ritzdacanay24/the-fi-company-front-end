<div class="inspection-dashboard">
  <!-- Header Section -->
  <div class="header-section">
    <div class="dashboard-title">
      <h1>
        <i class="fas fa-tachometer-alt"></i>
        Inspection Dashboard
      </h1>
      <p class="subtitle">Manage inspection checklists and monitor progress</p>
    </div>
    
    <div class="header-actions">
      <button 
        type="button" 
        class="btn btn-primary"
        (click)="createNewTemplate()">
        <i class="fas fa-plus"></i>
        New Template
      </button>
      
      <button 
        type="button" 
        class="btn btn-outline-secondary"
        (click)="refreshData()"
        [disabled]="isLoading">
        <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i>
        Refresh
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-section">
    <div class="row">
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="stat-card templates">
          <div class="stat-icon">
            <i class="fas fa-clipboard-list"></i>
          </div>
          <div class="stat-content">
            <h3>{{ stats.totalTemplates }}</h3>
            <p>Total Templates</p>
            <small class="stat-detail">{{ stats.activeTemplates }} active</small>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="stat-card instances">
          <div class="stat-icon">
            <i class="fas fa-tasks"></i>
          </div>
          <div class="stat-content">
            <h3>{{ stats.totalInstances }}</h3>
            <p>Total Inspections</p>
            <small class="stat-detail">{{ stats.completedInstances }} completed</small>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="stat-card pending">
          <div class="stat-icon">
            <i class="fas fa-clock"></i>
          </div>
          <div class="stat-content">
            <h3>{{ stats.pendingInstances }}</h3>
            <p>Pending</p>
            <small class="stat-detail">Require attention</small>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="stat-card completion">
          <div class="stat-icon">
            <i class="fas fa-stopwatch"></i>
          </div>
          <div class="stat-content">
            <h3>{{ formatDuration(stats.averageCompletionTime) }}</h3>
            <p>Avg. Time</p>
            <small class="stat-detail">Per inspection</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search and Filters -->
  <div class="filters-section">
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="searchInput">Search</label>
          <div class="input-group">
            <input
              id="searchInput"
              type="text"
              class="form-control"
              placeholder="Search templates, categories, or users..."
              [(ngModel)]="searchTerm"
              (input)="onSearchChange()">
            <div class="input-group-append">
              <span class="input-group-text">
                <i class="fas fa-search"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="form-group">
          <label for="periodSelect">Time Period</label>
          <select
            id="periodSelect"
            class="form-control"
            [(ngModel)]="selectedPeriod"
            (change)="onPeriodChange()">
            <option value="1">Last 1 day</option>
            <option value="7">Last 7 days</option>
            <option value="30">Last 30 days</option>
            <option value="90">Last 90 days</option>
          </select>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="form-group">
          <label>&nbsp;</label>
          <div class="quick-actions">
            <button 
              type="button" 
              class="btn btn-outline-info btn-sm"
              (click)="viewReports()">
              <i class="fas fa-chart-bar"></i>
              Reports
            </button>
            <button 
              type="button" 
              class="btn btn-outline-success btn-sm"
              (click)="exportData()">
              <i class="fas fa-download"></i>
              Export
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content" *ngIf="!isLoading">
    <div class="row">
      <!-- Templates Section -->
      <div class="col-lg-6 mb-4">
        <div class="content-card">
          <div class="card-header">
            <h5>
              <i class="fas fa-clipboard-list"></i>
              Templates
              <span class="badge badge-primary">{{ filteredTemplates.length }}</span>
            </h5>
            <button 
              type="button" 
              class="btn btn-outline-primary btn-sm"
              (click)="manageTemplates()">
              <i class="fas fa-cog"></i>
              Manage All
            </button>
          </div>
          
          <div class="card-body">
            <div class="templates-list">
              <div *ngFor="let template of filteredTemplates.slice(0, 5)" 
                   class="template-item"
                   (click)="viewTemplate(template)">
                <div class="template-info">
                  <div class="template-name">{{ template.name }}</div>
                  <div class="template-meta">
                    <span class="badge" [ngClass]="getStatusBadgeClass(template.status)">
                      {{ template.status | titlecase }}
                    </span>
                    <span class="meta-text">{{ template.category | titlecase }}</span>
                    <span class="meta-text">{{ template.items.length }} items</span>
                    <span class="meta-text">{{ getTemplateUsageCount(template) }} uses</span>
                  </div>
                </div>
                
                <div class="template-actions">
                  <button 
                    type="button" 
                    class="btn btn-outline-success btn-sm"
                    (click)="startInspection(template); $event.stopPropagation()"
                    title="Start Inspection">
                    <i class="fas fa-play"></i>
                  </button>
                  
                  <div class="dropdown">
                    <button 
                      type="button" 
                      class="btn btn-outline-secondary btn-sm dropdown-toggle"
                      data-toggle="dropdown"
                      (click)="$event.stopPropagation()">
                      <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="dropdown-menu">
                      <a class="dropdown-item" (click)="editTemplate(template)">
                        <i class="fas fa-edit"></i> Edit
                      </a>
                      <a class="dropdown-item" (click)="duplicateTemplate(template, $event)">
                        <i class="fas fa-copy"></i> Duplicate
                      </a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item text-danger" (click)="deleteTemplate(template, $event)">
                        <i class="fas fa-trash"></i> Delete
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              
              <div *ngIf="filteredTemplates.length === 0" class="empty-state">
                <i class="fas fa-clipboard-list fa-2x text-muted"></i>
                <p class="text-muted mt-2">No templates found</p>
                <button 
                  type="button" 
                  class="btn btn-primary btn-sm"
                  (click)="createNewTemplate()">
                  Create First Template
                </button>
              </div>
              
              <div *ngIf="filteredTemplates.length > 5" class="show-more">
                <button 
                  type="button" 
                  class="btn btn-outline-primary btn-sm"
                  (click)="manageTemplates()">
                  View All {{ filteredTemplates.length }} Templates
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Inspections Section -->
      <div class="col-lg-6 mb-4">
        <div class="content-card">
          <div class="card-header">
            <h5>
              <i class="fas fa-history"></i>
              Recent Inspections
              <span class="badge badge-info">{{ filteredInstances.length }}</span>
            </h5>
            <button 
              type="button" 
              class="btn btn-outline-info btn-sm"
              (click)="viewAllInstances()">
              <i class="fas fa-list"></i>
              View All
            </button>
          </div>
          
          <div class="card-body">
            <div class="instances-list">
              <div *ngFor="let instance of filteredInstances.slice(0, 5)" 
                   class="instance-item"
                   (click)="viewInstance(instance)">
                <div class="instance-info">
                  <div class="instance-name">{{ instance.template.name }}</div>
                  <div class="instance-meta">
                    <span class="badge" [ngClass]="getStatusBadgeClass(instance.status)">
                      {{ instance.status | titlecase }}
                    </span>
                    <span class="meta-text">{{ instance.assignedTo }}</span>
                    <span class="meta-text">{{ instance.startedDate | date:'short' }}</span>
                  </div>
                  
                  <div class="progress-bar-container" *ngIf="instance.status === 'in-progress'">
                    <div class="progress">
                      <div 
                        class="progress-bar bg-info" 
                        [style.width.%]="getProgressPercentage(instance)">
                      </div>
                    </div>
                    <small class="progress-text">{{ getProgressPercentage(instance).toFixed(0) }}% complete</small>
                  </div>
                </div>
                
                <div class="instance-actions">
                  <button 
                    *ngIf="instance.status === 'in-progress'"
                    type="button" 
                    class="btn btn-outline-primary btn-sm"
                    (click)="continueInspection(instance); $event.stopPropagation()"
                    title="Continue Inspection">
                    <i class="fas fa-play"></i>
                    Continue
                  </button>
                  
                  <button 
                    type="button" 
                    class="btn btn-outline-secondary btn-sm"
                    (click)="viewInstance(instance); $event.stopPropagation()"
                    title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>
              
              <div *ngIf="filteredInstances.length === 0" class="empty-state">
                <i class="fas fa-history fa-2x text-muted"></i>
                <p class="text-muted mt-2">No recent inspections</p>
                <p class="text-muted">Start an inspection from a template above</p>
              </div>
              
              <div *ngIf="filteredInstances.length > 5" class="show-more">
                <button 
                  type="button" 
                  class="btn btn-outline-info btn-sm"
                  (click)="viewAllInstances()">
                  View All {{ filteredInstances.length }} Inspections
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Start Section -->
    <div class="row">
      <div class="col-12">
        <div class="content-card quick-start">
          <div class="card-header">
            <h5>
              <i class="fas fa-rocket"></i>
              Quick Start
            </h5>
          </div>
          
          <div class="card-body">
            <div class="quick-start-actions">
              <div class="quick-action" (click)="createNewTemplate()">
                <div class="action-icon">
                  <i class="fas fa-plus-circle"></i>
                </div>
                <div class="action-content">
                  <h6>Create Template</h6>
                  <p>Build a new inspection checklist template</p>
                </div>
              </div>
              
              <div class="quick-action" (click)="manageTemplates()">
                <div class="action-icon">
                  <i class="fas fa-cogs"></i>
                </div>
                <div class="action-content">
                  <h6>Manage Templates</h6>
                  <p>View and edit existing templates</p>
                </div>
              </div>
              
              <div class="quick-action" (click)="viewAllInstances()">
                <div class="action-icon">
                  <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="action-content">
                  <h6>View Inspections</h6>
                  <p>Check all inspection instances</p>
                </div>
              </div>
              
              <div class="quick-action" (click)="viewReports()">
                <div class="action-icon">
                  <i class="fas fa-chart-line"></i>
                </div>
                <div class="action-content">
                  <h6>View Reports</h6>
                  <p>Analyze inspection data and trends</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="text-center py-5">
      <div class="spinner-border spinner-border-lg" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <p class="mt-3">Loading dashboard data...</p>
    </div>
  </div>
</div>