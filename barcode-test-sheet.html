<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Order Barcode Test Sheet</title>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: white;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
        }
        .barcode-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        .barcode-item {
            border: 1px solid #ddd;
            padding: 15px;
            text-align: center;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .barcode-label {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 10px;
            color: #333;
        }
        .barcode-text {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            font-family: monospace;
        }
        .so-info {
            font-size: 11px;
            color: #888;
            margin-top: 5px;
        }
        .print-instructions {
            margin-top: 30px;
            padding: 15px;
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            border-radius: 4px;
        }
        @media print {
            .print-instructions {
                display: none;
            }
            body {
                margin: 10px;
            }
            .barcode-grid {
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Sales Order Barcode Test Sheet</h1>
        <p>Generated on: <span id="currentDate"></span></p>
    </div>

    <div class="barcode-grid" id="barcodeGrid">
        <!-- Barcodes will be generated here -->
    </div>

    <div class="print-instructions">
        <h3>ðŸ“‹ Instructions:</h3>
        <ul>
            <li><strong>Print:</strong> Use Ctrl+P to print this page</li>
            <li><strong>Scan:</strong> Use any barcode scanner to scan the codes</li>
            <li><strong>Format:</strong> Each barcode contains the full sales order format (e.g., "SO131900-2")</li>
            <li><strong>Testing:</strong> These barcodes can be used to test the shipping readiness scanner</li>
        </ul>
    </div>

    <script>
        // Sales order data
        const salesOrders = [
            { so: 'SO131900', line: 2 },
            { so: 'SO131903', line: 5 },
            { so: 'SO131931', line: 1 },
            { so: 'SO131931', line: 2 },
            { so: 'SO132069', line: 1 },
            { so: 'SO132069', line: 2 },
            { so: 'SO132124', line: 4 },
            { so: 'SO132124', line: 5 },
            { so: 'SO132271', line: 1 },
            { so: 'SO132299', line: 1 },
            { so: 'SO132372', line: 1 }
        ];

        // Set current date
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString();

        // Generate barcodes
        function generateBarcodes() {
            const grid = document.getElementById('barcodeGrid');
            
            salesOrders.forEach((order, index) => {
                // Create barcode value (format: SO131900-2)
                const barcodeValue = `${order.so}-${order.line}`;
                
                // Create container
                const container = document.createElement('div');
                container.className = 'barcode-item';
                
                // Create label
                const label = document.createElement('div');
                label.className = 'barcode-label';
                label.textContent = `Sales Order: ${order.so}`;
                container.appendChild(label);
                
                // Create line info
                const lineInfo = document.createElement('div');
                lineInfo.className = 'so-info';
                lineInfo.textContent = `Line Number: ${order.line}`;
                container.appendChild(lineInfo);
                
                // Create SVG element for barcode
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.id = `barcode-${index}`;
                container.appendChild(svg);
                
                // Create text display
                const text = document.createElement('div');
                text.className = 'barcode-text';
                text.textContent = barcodeValue;
                container.appendChild(text);
                
                grid.appendChild(container);
                
                // Generate barcode using JsBarcode
                try {
                    JsBarcode(`#barcode-${index}`, barcodeValue, {
                        format: "CODE128",
                        width: 2,
                        height: 60,
                        displayValue: false,
                        margin: 10,
                        background: "#ffffff",
                        lineColor: "#000000"
                    });
                } catch (error) {
                    console.error(`Error generating barcode for ${barcodeValue}:`, error);
                    svg.innerHTML = '<text x="50%" y="50%" text-anchor="middle" fill="red">Error generating barcode</text>';
                }
            });
        }

        // Generate barcodes when page loads
        window.addEventListener('load', generateBarcodes);
    </script>
</body>
</html>
